<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nouveau Match - Jen et ses Saints</title>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;600&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-header: #f8f9fa;
            --text-primary: #202124;
            --text-secondary: #5f6368;
            --border-color: #e8eaed;
            --accent-orange: #ff6b35;
            --accent-blue: #0056D2;
            --accent-gold: #D4A400;
            --win-color: #34a853;
            --loss-color: #ea4335;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', 'Google Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            max-width: 600px;
            margin: 0 auto;
        }

        .app-container {
            padding: 24px;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Header */
        .header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 32px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .back-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: var(--bg-header);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            color: var(--text-primary);
        }

        .back-btn:hover {
            background: var(--border-color);
        }

        .header-content {
            flex: 1;
        }

        .header-title {
            font-family: 'Google Sans', sans-serif;
            font-size: 20px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .header-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        /* Views */
        .view {
            display: none;
            flex: 1;
            flex-direction: column;
        }

        .view.active {
            display: flex;
        }

        /* Type de match - Boutons */
        .match-type-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 16px;
            justify-content: center;
            padding: 20px 0;
        }

        .match-type-btn {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 28px 24px;
            border: 2px solid var(--border-color);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: var(--bg-primary);
        }

        .match-type-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .match-type-btn.championnat {
            border-color: var(--accent-blue);
        }

        .match-type-btn.championnat:hover {
            background: #f0f7ff;
        }

        .match-type-btn.ginette {
            border-color: var(--accent-gold);
        }

        .match-type-btn.ginette:hover {
            background: #fffbeb;
        }

        .match-type-icon {
            width: 56px;
            height: 56px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .match-type-icon.championnat {
            background: transparent;
        }

        .match-type-icon.ginette {
            background: transparent;
        }

        .match-type-content {
            flex: 1;
        }

        .match-type-title {
            font-family: 'Google Sans', sans-serif;
            font-size: 18px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .match-type-desc {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .match-type-arrow {
            color: var(--text-secondary);
            font-size: 24px;
        }

        /* Liste des matchs */
        .section-title {
            font-family: 'Google Sans', sans-serif;
            font-size: 16px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 16px;
        }

        .matches-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            overflow-y: auto;
            flex: 1;
        }

        .match-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .match-item:hover {
            border-color: var(--accent-blue);
            background: #f8faff;
        }

        .match-item.played {
            opacity: 0.5;
            pointer-events: none;
            background: var(--bg-header);
        }

        .match-number {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--bg-header);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            flex-shrink: 0;
        }

        .match-info {
            flex: 1;
        }

        .match-opponent {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .match-location {
            font-size: 12px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .location-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
        }

        .location-badge.domicile {
            background: #d1fae5;
            color: #059669;
        }

        .location-badge.exterieur {
            background: #fee2e2;
            color: #dc2626;
        }

        .match-arrow {
            color: var(--text-secondary);
            font-size: 18px;
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 48px 24px;
            color: var(--text-secondary);
        }

        .empty-state svg {
            width: 64px;
            height: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state p {
            font-size: 14px;
        }

        /* Confirmation dialog */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 100;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: 16px;
            padding: 24px;
            width: 90%;
            max-width: 360px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        .modal-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: #fef3c7;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
        }

        .modal-title {
            font-family: 'Google Sans', sans-serif;
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .modal-message {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 24px;
            line-height: 1.5;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
        }

        .btn-cancel {
            flex: 1;
            padding: 12px;
            border: 1px solid var(--border-color);
            background: white;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-cancel:hover {
            background: var(--bg-header);
        }

        .btn-confirm {
            flex: 1;
            padding: 12px;
            border: none;
            background: var(--loss-color);
            color: white;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-confirm:hover {
            background: #dc2626;
        }

        /* Ginette rounds */
        .ginette-rounds {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .round-btn {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px 20px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            background: var(--bg-primary);
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
        }

        .round-btn:hover {
            border-color: var(--accent-gold);
            background: #fffbeb;
        }

        .round-btn.finale {
            border-color: var(--accent-gold);
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
        }

        .round-btn.finale:hover {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
        }

        .round-number {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--bg-header);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            flex-shrink: 0;
        }

        .round-btn.finale .round-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }

        .round-name {
            flex: 1;
            font-family: 'Google Sans', sans-serif;
            font-size: 15px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .round-arrow {
            color: var(--text-secondary);
            font-size: 20px;
        }

        /* Form styles for Ginette modal */
        .form-group {
            margin-bottom: 16px;
            text-align: left;
        }

        .form-label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 6px;
        }

        .form-input {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            transition: border-color 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .form-select {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            background: white;
            cursor: pointer;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .btn-save {
            flex: 1;
            padding: 12px;
            border: none;
            background: var(--accent-gold);
            color: white;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-save:hover {
            background: #b8960a;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <button class="back-btn" onclick="handleBack()">
                <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                </svg>
            </button>
            <div class="header-content">
                <h1 class="header-title" id="headerTitle">Nouveau Match</h1>
                <p class="header-subtitle" id="headerSubtitle">Choisir le type de match</p>
            </div>
        </header>

        <!-- Vue 1: Choix du type de match -->
        <div class="view active" id="viewType">
            <div class="match-type-section">
                <button class="match-type-btn championnat" onclick="showChampionnat()">
                    <div class="match-type-icon championnat">
                        <span style="font-size: 40px;">üèê</span>
                    </div>
                    <div class="match-type-content">
                        <div class="match-type-title">Championnat</div>
                        <div class="match-type-desc">Match officiel FSGT 4√ó4</div>
                    </div>
                    <span class="match-type-arrow">‚Ä∫</span>
                </button>

                <button class="match-type-btn ginette" onclick="showGinette()">
                    <div class="match-type-icon ginette">
                        <span style="font-size: 40px;">üèÜ</span>
                    </div>
                    <div class="match-type-content">
                        <div class="match-type-title">Ginette</div>
                        <div class="match-type-desc">Tournoi sp√©cial</div>
                    </div>
                    <span class="match-type-arrow">‚Ä∫</span>
                </button>
            </div>
        </div>

        <!-- Vue 2: Liste des matchs Championnat -->
        <div class="view" id="viewChampionnat">
            <h2 class="section-title">S√©lectionner le match</h2>
            <div class="matches-list" id="matchesList">
                <!-- Matchs g√©n√©r√©s dynamiquement -->
            </div>
        </div>

        <!-- Vue 3: Ginette - Tours -->
        <div class="view" id="viewGinette">
            <h2 class="section-title">S√©lectionner le tour</h2>
            <div class="ginette-rounds">
                <button class="round-btn" onclick="openGinetteModal('1er Tour')">
                    <span class="round-number">1</span>
                    <span class="round-name">1er Tour</span>
                    <span class="round-arrow">‚Ä∫</span>
                </button>
                <button class="round-btn" onclick="openGinetteModal('2√®me Tour')">
                    <span class="round-number">2</span>
                    <span class="round-name">2√®me Tour</span>
                    <span class="round-arrow">‚Ä∫</span>
                </button>
                <button class="round-btn" onclick="openGinetteModal('1/8√®me de finale')">
                    <span class="round-number">8</span>
                    <span class="round-name">1/8√®me de finale</span>
                    <span class="round-arrow">‚Ä∫</span>
                </button>
                <button class="round-btn" onclick="openGinetteModal('1/4 de finale')">
                    <span class="round-number">4</span>
                    <span class="round-name">1/4 de finale</span>
                    <span class="round-arrow">‚Ä∫</span>
                </button>
                <button class="round-btn" onclick="openGinetteModal('1/2 finale')">
                    <span class="round-number">2</span>
                    <span class="round-name">1/2 finale</span>
                    <span class="round-arrow">‚Ä∫</span>
                </button>
                <button class="round-btn finale" onclick="openGinetteModal('Finale')">
                    <span class="round-icon">üèÜ</span>
                    <span class="round-name">Finale</span>
                    <span class="round-arrow">‚Ä∫</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Ginette - Saisie adversaire -->
    <div class="modal-overlay" id="ginetteModalOverlay" onclick="closeGinetteModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <h3 class="modal-title" id="ginetteModalTitle">1er Tour</h3>
            <form id="ginetteForm" onsubmit="saveGinetteMatch(event)">
                <input type="hidden" id="ginetteRound" value="">
                <div class="form-group">
                    <label class="form-label" for="ginetteOpponent">Nom de l'√©quipe</label>
                    <input type="text" class="form-input" id="ginetteOpponent" placeholder="Entrer le nom de l'√©quipe" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="ginetteLevel">Niveau de l'√©quipe</label>
                    <select class="form-select" id="ginetteLevel" required>
                        <option value="">S√©lectionner un niveau</option>
                        <optgroup label="Comp√©tition">
                            <option value="√âlite">√âlite</option>
                            <option value="Hard">Hard</option>
                            <option value="Medium">Medium</option>
                            <option value="Easy">Easy</option>
                            <option value="Starter">Starter</option>
                        </optgroup>
                        <optgroup label="Tableau">
                            <option value="OR">OR</option>
                            <option value="ARGENT">ARGENT</option>
                        </optgroup>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-cancel" onclick="closeGinetteModal()">Annuler</button>
                    <button type="submit" class="btn-save">Continuer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de confirmation -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-icon">
                <svg width="24" height="24" fill="#d97706" viewBox="0 0 24 24">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                </svg>
            </div>
            <h3 class="modal-title">Annuler la cr√©ation ?</h3>
            <p class="modal-message">Voulez-vous annuler la cr√©ation de ce match ? Les donn√©es non enregistr√©es seront perdues.</p>
            <div class="modal-actions">
                <button class="btn-cancel" onclick="closeModal()">Continuer</button>
                <button class="btn-confirm" onclick="confirmCancel()">Annuler le match</button>
            </div>
        </div>
    </div>

    <script>
        // Liste des matchs du championnat
        const championnatMatches = [
            { opponent: "Red Hot Sucy P√©p√®re", location: "ext√©rieur" },
            { opponent: "Manu Andy-sport", location: "domicile" },
            { opponent: "Bi√®res et le loup", location: "domicile" },
            { opponent: "StarPAFF", location: "ext√©rieur" },
            { opponent: "Kiki Team", location: "ext√©rieur" },
            { opponent: "RSC Champigny 1", location: "domicile" },
            { opponent: "Marvels 4", location: "domicile" },
            { opponent: "Rhinos F√©roces", location: "ext√©rieur" },
            { opponent: "Les Rescap√©s", location: "domicile" },
            { opponent: "Red Hot Sucy P√©p√®re", location: "domicile" },
            { opponent: "Manu Andy-sport", location: "ext√©rieur" },
            { opponent: "Bi√®res et le loup", location: "ext√©rieur" },
            { opponent: "StarPAFF", location: "domicile" },
            { opponent: "Kiki Team", location: "domicile" },
            { opponent: "RSC Champigny 1", location: "ext√©rieur" },
            { opponent: "Marvels 4", location: "ext√©rieur" },
            { opponent: "Rhinos F√©roces", location: "domicile" },
            { opponent: "Les Rescap√©s", location: "ext√©rieur" }
        ];

        // √âtat de la vue actuelle
        let currentView = 'type';
        
        // Matchs jou√©s (stock√©s en localStorage)
        let playedMatches = JSON.parse(localStorage.getItem('volleyball_played_matches')) || [];

        // Navigation
        function showView(viewId) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById(viewId).classList.add('active');
        }

        function showChampionnat() {
            currentView = 'championnat';
            document.getElementById('headerTitle').textContent = 'Championnat';
            document.getElementById('headerSubtitle').textContent = 'S√©lectionner le match';
            renderMatchesList();
            showView('viewChampionnat');
        }

        function showGinette() {
            currentView = 'ginette';
            document.getElementById('headerTitle').textContent = 'Ginette';
            document.getElementById('headerSubtitle').textContent = 'Tournoi sp√©cial';
            showView('viewGinette');
        }

        function handleBack() {
            if (currentView === 'type') {
                // Retour vers le menu principal - toujours demander confirmation
                document.getElementById('modalOverlay').classList.add('active');
            } else {
                // Retour vers le choix du type
                currentView = 'type';
                document.getElementById('headerTitle').textContent = 'Nouveau Match';
                document.getElementById('headerSubtitle').textContent = 'Choisir le type de match';
                showView('viewType');
            }
        }

        function closeModal(event) {
            if (event && event.target !== event.currentTarget) return;
            document.getElementById('modalOverlay').classList.remove('active');
        }

        function confirmCancel() {
            window.location.href = 'index.html';
        }

        // Rendu de la liste des matchs
        function renderMatchesList() {
            const container = document.getElementById('matchesList');
            
            const availableMatches = championnatMatches.filter((match, index) => {
                const matchId = `champ_${index}`;
                return !playedMatches.includes(matchId);
            });

            if (availableMatches.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <svg fill="currentColor" viewBox="0 0 24 24">
                            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                        </svg>
                        <p>Tous les matchs ont √©t√© jou√©s !</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = championnatMatches.map((match, index) => {
                const matchId = `champ_${index}`;
                const isPlayed = playedMatches.includes(matchId);
                const locationClass = match.location === 'domicile' ? 'domicile' : 'exterieur';
                const locationLabel = match.location === 'domicile' ? 'Domicile' : 'Ext√©rieur';

                if (isPlayed) return ''; // Ne pas afficher les matchs jou√©s

                return `
                    <div class="match-item" onclick="selectMatch(${index})">
                        <div class="match-number">${index + 1}</div>
                        <div class="match-info">
                            <div class="match-opponent">${match.opponent}</div>
                            <div class="match-location">
                                <span class="location-badge ${locationClass}">${locationLabel}</span>
                            </div>
                        </div>
                        <span class="match-arrow">‚Ä∫</span>
                    </div>
                `;
            }).join('');
        }

        // S√©lectionner un match
        function selectMatch(index) {
            const match = championnatMatches[index];
            // Stocker le match s√©lectionn√©
            localStorage.setItem('volleyball_current_match', JSON.stringify({
                id: `champ_${index}`,
                type: 'championnat',
                opponent: match.opponent,
                location: match.location,
                matchNumber: index + 1
            }));
            // Rediriger vers la configuration du match
            window.location.href = 'match-config.html';
        }

        // Ginette - Ouvrir modal
        function openGinetteModal(round) {
            document.getElementById('ginetteRound').value = round;
            document.getElementById('ginetteModalTitle').textContent = round;
            document.getElementById('ginetteOpponent').value = '';
            document.getElementById('ginetteLevel').value = '';
            document.getElementById('ginetteModalOverlay').classList.add('active');
            document.getElementById('ginetteOpponent').focus();
        }

        // Ginette - Fermer modal
        function closeGinetteModal(event) {
            if (event && event.target !== event.currentTarget) return;
            document.getElementById('ginetteModalOverlay').classList.remove('active');
        }

        // Ginette - Sauvegarder et continuer
        function saveGinetteMatch(event) {
            event.preventDefault();
            const round = document.getElementById('ginetteRound').value;
            const opponent = document.getElementById('ginetteOpponent').value.trim();
            const level = document.getElementById('ginetteLevel').value;

            // Stocker le match Ginette s√©lectionn√©
            localStorage.setItem('volleyball_current_match', JSON.stringify({
                id: `ginette_${Date.now()}`,
                type: 'ginette',
                round: round,
                opponent: opponent,
                level: level
            }));

            // Rediriger vers la configuration du match
            window.location.href = 'match-config.html';
        }

        // Init
        renderMatchesList();
    </script>
</body>
</html>
